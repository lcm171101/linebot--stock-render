
<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>LINE 推播名單管理</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
  <style>body { padding: 2rem; }</style>
</head>
<body>
  <h1 class="mb-4">LINE Bot 推播名單</h1>
  <h3>使用者清單</h3>
  <ul id="userList" class="list-group mb-4"></ul>

  <h3>群組清單</h3>
  <ul id="groupList" class="list-group"></ul>

  <script>
    async function loadData() {
      const users = await fetch('/api/users').then(res => res.json());
      const groups = await fetch('/api/groups').then(res => res.json());

      const userList = document.getElementById('userList');
      users.forEach(u => {
        const li = document.createElement('li');
        li.className = 'list-group-item d-flex justify-content-between align-items-center';
        li.innerHTML = \`\${u.id}
          <button class="btn btn-danger btn-sm" onclick="deleteItem('user', '\${u.id}')">刪除</button>\`;
        userList.appendChild(li);
      });

      const groupList = document.getElementById('groupList');
      groups.forEach(g => {
        const li = document.createElement('li');
        li.className = 'list-group-item d-flex justify-content-between align-items-center';
        li.innerHTML = \`\${g.id}
          <button class="btn btn-danger btn-sm" onclick="deleteItem('group', '\${g.id}')">刪除</button>\`;
        groupList.appendChild(li);
      });
    }

    async function deleteItem(type, id) {
      if (!confirm('確定要刪除 ' + id + ' 嗎？')) return;
      await fetch('/api/delete', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ type, id })
      });
      location.reload();
    }

    loadData();
  </script>
</body>
</html>
